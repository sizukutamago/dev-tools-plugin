# Codex Collab

Claude Code と Codex が tmux でチャットするスキル。設計相談やコードレビューに使用。

## 概要

このスキルは、Claude Code が Codex とペアプログラミング的に連携するためのものです。Codex は設計相談役として機能し、Claude Code が実装を担当します。

**主なユースケース:**
- 設計アプローチの相談
- パターン選択のアドバイス
- コードレビュー
- セキュリティリスクの検討
- パフォーマンス改善のアイデア出し

## 前提条件

| 条件 | 必須 | 説明 |
|------|------|------|
| `codex` CLI | ○ | `npm install -g @openai/codex` |
| Codex 認証 | ○ | `codex login` または `OPENAI_API_KEY` |
| `tmux` | ○ | `brew install tmux` |
| tmux セッション | ○ | tmux セッション内で実行すること |

## アーキテクチャ

Codex はバックグラウンドプロセスではなく、**別ペイン**で起動します。

```
┌─────────────────────┬─────────────────────┐
│                     │                     │
│   Claude Code       │   Codex             │
│   (メインペイン)    │   (サブペイン)      │
│                     │                     │
│   実装作業          │   相談・レビュー    │
│                     │                     │
└─────────────────────┴─────────────────────┘
```

### なぜペインを使うのか

- 両方の出力をリアルタイムで確認可能
- ユーザーが手動で Codex とやり取りすることも可能
- セッション終了時にペインを閉じるだけで済む

## 関連スキル

| スキル | 用途 | 使い分け |
|--------|------|----------|
| **tmux-ai-chat** | tmux 操作の共通基盤 | 全ての AI 連携で使用可能 |
| **ai-research** | Web 検索・調査 | 情報収集・出典確認が必要な場合 |
| **codex-collab** | 設計相談・レビュー | アーキテクチャ・実装方針の相談 |

### ai-research との連携

調査結果を受けて設計相談する場合:

1. `ai-research` で Gemini に調査依頼 → RESEARCH MEMO 作成
2. `codex-collab` で Codex に設計相談（RESEARCH MEMO を引用）

```
User: "JWT vs セッション認証について調査して、その後設計相談したい"

Claude:
1. ai-research で Gemini に調査依頼
2. RESEARCH MEMO を受け取る
3. codex-collab で Codex に「この調査結果を踏まえて、どちらを採用すべき？」
4. Codex のアドバイスを受けて実装
```

## トラブルシューティング

| 状況 | 症状 |
|------|------|
| タイムアウト | capture 出力が空/変化なし |
| Codex 未応答 | プロンプトが表示されたまま |
| ペイン消失 | `can't find pane` エラー |
| 接続エラー | API エラーメッセージ |

詳細な対応手順・リカバリーコマンドは [SKILL.md](./SKILL.md) の「エラーハンドリング」「自動リカバリーフロー」セクションを参照。

## 関連ドキュメント

- [SKILL.md](./SKILL.md) - AI 向け実行手順
